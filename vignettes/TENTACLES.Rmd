---
title: "TENTACLES"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{TENTACLES}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
# library(geneMarkR)
devtools::document()
devtools::load_all()

# Load data
df.count <- read.csv2("../../Varie/ACC_Count.csv", row.names = 1)
df.clin <- read.csv2("../../Varie/ACC_Pheno.csv", row.names = 1)
```

##Pre-Processing

```{r preProcess}
# pre-Process data
a <- preProcess(df.count = df.count, df.clin = df.clin, batch = "patient.gender")
```

##Run Classifiers

```{r runClassifiers}
# Run classifiers
b <- runClassifiers(a, models = c("bag_mlp", "rand_forest", "mlp", "C5_rules"),
                    selector.recipes = c("boruta", "roc", "boruta", "boruta"), 
                    filter = TRUE, downsample = TRUE)
```

##Get and Test Consensus

```{r getConsensus}
# Get and test consensus
c <- getConsensus(b, n.min = 5)
```

##Validation

```{r validation, message=FALSE, warning=TRUE}
# Import NEW data
count_table <- as.data.frame((b@data$adjusted.data))
gene_list <- c$consensusGenes
labels <- as.factor(b@data$metadata$class)

# Validation
tictoc::tic()
d <- valConsensus(count_table, gene_list, labels, N = 10, metric = "FScore")
tictoc::toc()
```

```{r}
# Gira fino a qui
```
